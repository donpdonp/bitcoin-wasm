<!DOCTYPE html>
<html lang="en"> 
<head>
<meta charset="utf-8"/>
<style>
.codestack { 
 display: grid;
 grid-template-columns: 1fr 1fr;
}

</style>
<script src="bridge.js"></script>
</head>
<body>
<div>
bitcoin script wasm
</div>

<div class="codestack">

<div class="code">
<div>
OPCODES
</div>
<input>
</div>

<div class="stack">
Code
</div>

</div>

<script>
Module['onRuntimeInitialized'] = onRuntimeInitialized;
function onRuntimeInitialized() {
//  Module.ccall('jsgo', 'boolean', [])
  var ops = ["OP_RETURN", "OP_DO"]
  var strBufArr = ops.map(function(s){ 
    var b = Module._malloc(s.length+1); 
    Module.writeAsciiToMemory(s, b);
    return b } )
  var heapBytes = _arrayToHeap(new Uint32Array(strBufArr))
  Module.ccall('stringCompile', 'boolean', ['number', 'number'], [heapBytes.byteOffset, ops.length])
}

function _arrayToHeap(typedArray){
  var numBytes = typedArray.length * typedArray.BYTES_PER_ELEMENT;
  var ptr = Module._malloc(numBytes);
  var heapBytes = new Uint8Array(Module.HEAPU8.buffer, ptr, numBytes);
  heapBytes.set(new Uint8Array(typedArray.buffer));
  return heapBytes;
}

</script>

</body>
</html>
